<!DOCTYPE html>
<html>
<head>
    <title>Expenses</title>
</head>
<body>
    <h1>Uploaded Expenses</h1>
    <form method="GET" style="margin-bottom: 20px;">
    <input type="text" name="title" placeholder="Search Title" value="{{ request.GET.title }}">
    
    <input type="number" step="0.01" name="min_amount" placeholder="Min Amount" value="{{ request.GET.min_amount }}">
    <input type="number" step="0.01" name="max_amount" placeholder="Max Amount" value="{{ request.GET.max_amount }}">
    
    <input type="date" name="start_date" value="{{ request.GET.start_date }}">
    <input type="date" name="end_date" value="{{ request.GET.end_date }}">
    
    <select name="sort">
        <option value="">-- Sort By --</option>
        <option value="amount_asc" {% if request.GET.sort == 'amount_asc' %}selected{% endif %}>Amount (Low to High)</option>
        <option value="amount_desc" {% if request.GET.sort == 'amount_desc' %}selected{% endif %}>Amount (High to Low)</option>
        <option value="date_asc" {% if request.GET.sort == 'date_asc' %}selected{% endif %}>Date (Oldest First)</option>
        <option value="date_desc" {% if request.GET.sort == 'date_desc' %}selected{% endif %}>Date (Newest First)</option>
    </select>
    
    <button type="submit">Apply</button>
    <a href="{% url 'expense_list' %}">Reset</a>
    </form>

    <table border="1">
    <tr>
        <th>Title</th>
        <th>Amount</th>
        <th>Date</th>
        <th>Receipt</th>
        <th>Notes</th>
    </tr>
    {% for expense in expenses %}
    <tr>
        <td>{{ expense.title }}</td>
        <td>{{ expense.amount }}</td>
        <td>{{ expense.date|date:"M. j, Y" }}</td>
        <td>
            {% if expense.receipt %}
                <a href="{{ expense.receipt.url }}" target="_blank">
                    <img src="{{ expense.receipt.url }}" alt="Receipt" width="100" />
                </a>
            {% else %}
                No Receipt
            {% endif %}
        </td>
        <td>{{ expense.notes|truncatewords:20 }}</td>
    </tr>
    {% endfor %}
</table>

    <a href="{% url 'upload_expense' %}">Upload Another Expense</a>
</body>
</html>
